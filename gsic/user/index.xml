<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
<?asciidoc-toc?>
<?asciidoc-numbered?>

<book lang="en">
<bookinfo>
    <title>Security: GSI C User&#8217;s Guide</title>
</bookinfo>
<preface>
<title></title>
<simpara>Authentication in the Globus Toolkit is based on X.509 certificates.
This document describes how to acquire and use the certificates that you
will need to authenticate yourself to Globus services.</simpara>
</preface>
<chapter id="gsic-user-usagescenarios">
<title>Usage scenarios</title>
<section id="gsic-user-basic-procedure">
<title>Basic procedure for using GSI C</title>
<simpara>In most cases, an individual will do the following:</simpara>
<itemizedlist>
<listitem>
<simpara>
Acquire a user certificate from a certification authority (CA) with <ulink url="../..gsic/user/index.html#grid-cert-request">grid-cert-request</ulink>. This certificate will typically be valid for a year or more and will be stored in a file in the individual&#8217;s home directory.
</simpara>
<simpara>It is important to keep in mind when your cert will expire - after your user certificate expires, you may not be able to use secure services in GT!</simpara>
</listitem>
<listitem>
<simpara>
Use the end-user certificate to create a proxy certificate using <ulink url="../..gsic/user/index.html#grid-proxy-init">grid-proxy-init</ulink>. This will be used to authenticate the individual to grid services. Proxy certificates typically have a much shorter lifetime than end-user certificates (usually 12 hours). Once your proxy certificate expires, simply rerun <emphasis role="strong"><literal>grid-proxy-init</literal></emphasis>.
</simpara>
</listitem>
</itemizedlist>
</section>
</chapter>
<chapter id="gsic-cmd">
<title>GSI Commands</title>
<section id="_globus_update_certificate_dir_8">
<title>GLOBUS-UPDATE-CERTIFICATE-DIR(8)</title>
<section id="_name">
<title>NAME</title>
<simpara>globus-update-certificate-dir - Update symlinks in the trusted CA directory</simpara>
</section>
<section id="_synopsis">
<title>SYNOPSIS</title>
<simpara><emphasis role="strong"><literal>globus-update-certificate-dir</literal></emphasis> [<literal>-help</literal> ] [<literal>-d</literal> <emphasis>DIRECTORY</emphasis>]</simpara>
</section>
<section id="_description">
<title>Description</title>
<simpara>The <emphasis role="strong"><literal>globus-update-certificate-dir</literal></emphasis> program creates symlinks
between files (CA certificates, certificate revocation lists, signing
policy, and certificate request configuration files) using the
certificate hash the installed version of OpenSSL uses. OpenSSL 1.0.0
uses a different name hashing algorithm than previous versions, so CA
distributions created with older versions of OpenSSL might not be able
to locate trusted CAs and related files. Running
<emphasis role="strong"><literal>globus-update-certificate-dir</literal></emphasis> against a trusted CA directory
will add symlinks to the files to the hash if needed.</simpara>
<simpara>The full set of command-line options to
<emphasis role="strong"><literal>globus-update-certificate-dir</literal></emphasis> consists of:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong">-help</emphasis>
</term>
<listitem>
<simpara>
     Display a help message to standard output and exit
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-d <emphasis>DIRECTORY</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Create links in the trusted CA directory <emphasis>DIRECTORY</emphasis> instead of using the default search path.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_environment">
<title>Environment</title>
<simpara>If the following variables affect the execution of
<emphasis role="strong"><literal>globus-update-certificate-dir</literal></emphasis></simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong"><literal>X509_CERT_DIR</literal></emphasis>
</term>
<listitem>
<simpara>
     Default trusted certificate directory.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong"><literal>HOME</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the current user&#8217;s home directory.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong"><literal>GLOBUS_LOCATION</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the Globus installation.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
</section>
<section id="grid-cert-diagnostics">
<title>GRID-CERT-DIAGNOSTICS(1)</title>
<section id="_name_2">
<title>NAME</title>
<simpara>grid-cert-diagnostics - Print diagnostic information about certificates and keys</simpara>
</section>
<section id="_synopsis_2">
<title>SYNOPSIS</title>
<simpara><emphasis role="strong"><literal>grid-cert-diagnostics</literal></emphasis> [<literal>-h</literal> ] | [<literal>-help</literal> ] [<literal>-p</literal> ] [<literal>-n</literal> ] [<literal>-c</literal> <emphasis>CERTIFICATE</emphasis>]</simpara>
</section>
<section id="_description_2">
<title>Description</title>
<simpara>The <emphasis role="strong"><literal>grid-cert-diagnostics</literal></emphasis> program displays information about the
current user&#8217;s security environment, including information about
security-related environment variables, security directory search path,
personal key and certificates, and trusted certificates. It is intended
to provide information to help diagnose problems using GSIC.</simpara>
<simpara>By default, <emphasis role="strong"><literal>grid-cert-diagnostics</literal></emphasis> prints out information
regarding the environment and trusted certificate directory. If the <emphasis>-p</emphasis>
command-line option is used, then additional information about the
current user&#8217;s default certificate and key will be printed.</simpara>
<simpara>The full set of command-line options to <emphasis role="strong"><literal>grid-cert-diagnostics</literal></emphasis>
consists of:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong">-h, -help</emphasis>
</term>
<listitem>
<simpara>
     Display a help message and exit.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-p</emphasis>
</term>
<listitem>
<simpara>
     Display information about the personal certificate and key that is the current user&#8217;s default credential.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-n</emphasis>
</term>
<listitem>
<simpara>
     Check time synchronization with the <emphasis role="strong"><literal>ntpdate</literal></emphasis> command.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-c <emphasis>CERTIFICATE</emphasis>, -c -</emphasis>
</term>
<listitem>
<simpara>
     Check the validity of the certificate in the file named by <emphasis>CERTIFICATE</emphasis> or standard input if the parameter to <emphasis>-c</emphasis> is <literal>-</literal>.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_examples">
<title>Examples</title>
<simpara>In this example, we see the default mode of checking the default
security environment for the system, without processing the user&#8217;s key
and certificate. Note the user receives a warning about a
<literal>cog.properties</literal> and about an expired CA certificate.  and about an
expired CA certificate.</simpara>
<screen>%  grid-cert-diagnostics

Checking Environment Variables
==============================
Checking if X509_CERT_DIR is set... no
Checking if X509_USER_CERT is set... no
Checking if X509_USER_KEY is set... no
Checking if X509_USER_PROXY is set... no

Checking Security Directories
=======================
Determining trusted cert path... /etc/grid-security/certificates
Checking for cog.properties... found
    WARNING: If the cog.properties file contains security properties,
             Java apps will ignore the security paths described in the GSI
             documentation

Checking trusted certificates...
================================
Getting trusted certificate list...
Checking CA file /etc/grid-security/certificates/1c4f4c48.0... ok
Verifying certificate chain for "/etc/grid-security/certificates/1c3f2ca8.0"... ok
Checking CA file /etc/grid-security/certificates/9d8788eb.0... ok
Verifying certificate chain for "/etc/grid-security/certificates/9d8753eb.0"... failed
    globus_credential: Error verifying credential: Failed to verify credential
    globus_gsi_callback_module: Could not verify credential
    globus_gsi_callback_module: The certificate has expired:
    Credential with subject: /DC=org/DC=example/OU=grid/CN=CA has expired.</screen>
<simpara>In this example, we show a user with a mismatched private key and
certificate:</simpara>
<screen>%  grid-cert-diagnostics -p

Checking Environment Variables
==============================
Checking if X509_CERT_DIR is set... no
Checking if X509_USER_CERT is set... no
Checking if X509_USER_KEY is set... no
Checking if X509_USER_PROXY is set... no

Checking Security Directories
=======================
Determining trusted cert path... /etc/grid-security/certificates
Checking for cog.properties... not found

Checking Default Credentials
==============================
Determining certificate and key file names... ok
Certificate Path: "/home/juser/.globus/usercert.pem"
Key Path: "/home/juser/.globus/userkey.pem"
Reading certificate... ok
Reading private key...
ok
Checking Certificate Subject...
"/O=Grid/OU=Example/OU=User/CN=Joe User"
Checking cert... ok
Checking key... ok
Checking that certificate contains an RSA key... ok
Checking that private key is an RSA key... ok
Checking that public and private keys have the same modulus... failed
Private key modulus: D294849E37F048C3B5ACEEF2CCDF97D88B679C361E29D5CB5
219C3E948F3E530CFC609489759E1D751F0ACFF0515A614276A0F4C11A57D92D7165B8
FA64E3140155DE448D45C182F4657DA13EDA288423F5B9D169DFF3822EFD81EB2E6403
CE3CB4CCF96B65284D92592BB1673A18354DA241B9AFD7F494E54F63A93E15DCAE2
Public key modulus : C002C7B329B13BFA87BAF214EACE3DC3D490165ACEB791790
600708C544175D9193C9BAC5AED03B7CB49BB6AE6D29B7E635FAC751E9A6D1CEA98022
6F1B63002902D6623A319E4682E7BFB0968DCE962CF218AAD95FAAD6A0BA5C42AA9AAF
7FDD32B37C6E2B2FF0E311310AA55FFB9EAFDF5B995C7D9EEAD8D5D81F3531E0AE5
Certificate and and private key don't match</screen>
</section>
</section>
<section id="grid-cert-info">
<title>GRID-CERT-INFO(1)</title>
<section id="_name_3">
<title>NAME</title>
<simpara>grid-cert-info - Display information about a certificate</simpara>
</section>
<section id="_synopsis_3">
<title>SYNOPSIS</title>
<simpara><emphasis role="strong"><literal>grid-cert-info</literal></emphasis> [<literal>-help</literal> ] [<literal>-usage</literal> ] [<literal>-version</literal> ] [<literal>-versions</literal> ]</simpara>
</section>
<section id="_description_3">
<title>Description</title>
<simpara>The <emphasis role="strong"><literal>grid-cert-info</literal></emphasis> program displays information contained within
a certificate file. By default it shows a text representation of the
entire certificate. Specific facts about the certificate can be shown
instead by using command-line options. If any of those options are used,
then the default display is suppressed. This can be added to the output
by using the <emphasis>-all</emphasis> command-line option.</simpara>
<simpara>If multiple display options are included on the command-line, the facts
related to those will be displayed on separate lines in the order that
they occur. If an option is specified multiple time, that fact will be
displayed multiple times.</simpara>
<simpara>The full set of command-line options to <emphasis role="strong"><literal>grid-cert-info</literal></emphasis> are:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong">-help, -usage</emphasis>
</term>
<listitem>
<simpara>
     Display the command-line options to <emphasis role="strong"><literal>grid-cert-info</literal></emphasis> and exit.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-version, -versions</emphasis>
</term>
<listitem>
<simpara>
     Display the version number of the <emphasis role="strong"><literal>grid-cert-info</literal></emphasis> command. The second form includes more details.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-file <emphasis>CERTIFICATE-FILE</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Display information about the first certificate contained in the file named by <emphasis>CERTIFICATE-FILE</emphasis> instead of the default user certificate.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-rfc2253</emphasis>
</term>
<listitem>
<simpara>
     Display X.509 distinguished names using the string representation defined in RFC 2253 instead of the default OpenSSL oneline format.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-all</emphasis>
</term>
<listitem>
<simpara>
     Display the text representation of the entire certificate in addition to any other facts requested by command-line options. This is the default if no fact-specific command-line options are used.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-subject, -s</emphasis>
</term>
<listitem>
<simpara>
     Display the subject name of the X.509 certificate.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-issuer, -i</emphasis>
</term>
<listitem>
<simpara>
     Display the issuer name of the X.509 certificate.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-issuerhash, -ih</emphasis>
</term>
<listitem>
<simpara>
     Display the default hash of the issuer name of the X.509 certificate. This can be used to locate which CA certificate in the trusted certificate directory issued the certifcate being inspected.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-startdate, -sd</emphasis>
</term>
<listitem>
<simpara>
     Display a string representation of the date and time when the certificate is valid from. This is displayed in the format used by the OpenSSL <emphasis role="strong"><literal>x509</literal></emphasis> command.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-enddate, -dd</emphasis>
</term>
<listitem>
<simpara>
     Display a string representation of the date and time when the certificate is valid until. This is displayed in the format used by the OpenSSL <emphasis role="strong"><literal>x509</literal></emphasis> command.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_examples_2">
<title>Examples</title>
<simpara>Display the validity times for the default certificate</simpara>
<screen>%  grid-cert-info -sd -ed
Aug 31 12:33:47 2009 GMT
Aug 31 12:33:47 2010 GMT</screen>
<simpara>Display the same information about a different certificate specified on
the command-line</simpara>
<screen>%  grid-cert-info -sd -ed -f /etc/grid-security/hostcert.pem
Jan 21 12:24:48 2003 GMT
Jul 15 11:30:57 2020 GMT</screen>
<simpara>Display the subject of a certificate in both the default and the RFC
2253 forms.</simpara>
<screen>%  grid-cert-info -subject
/DC=org/DC=example/DC=grid/CN=Joe User
%  grid-cert-info -subject -rfc2253
CN=Joe User,DC=grid,DC=example,DC=org</screen>
</section>
<section id="_environment_variables">
<title>Environment Variables</title>
<simpara>The following environment variables affect the execution of
<emphasis role="strong"><literal>grid-cert-info</literal></emphasis>:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong"><literal>X509_USER_CERT</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the default certificate file to inspect.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
</section>
<section id="grid-cert-request">
<title>GRID-CERT-REQUEST(1)</title>
<section id="_name_4">
<title>NAME</title>
<simpara>grid-cert-request - Generate a X.509 certificate request and corresponding private
    key</simpara>
</section>
<section id="_synopsis_4">
<title>SYNOPSIS</title>
<simpara><emphasis role="strong"><literal>grid-cert-request</literal></emphasis> [<literal>-help</literal> ] [<literal>-h</literal> ] [<literal>-?</literal> ] [<literal>-usage</literal> ] <?asciidoc-br?>
<?asciidoc-br?>
 [<literal>-version</literal> ] [<literal>-versions</literal> ]</simpara>
</section>
<section id="_description_4">
<title>Description</title>
<simpara>The <emphasis role="strong"><literal>grid-cert-request</literal></emphasis> program generates an X.509 Certificate
Request and corresponding private key for the specified name, host, or
service. It is intended to be used with a CA implemented using the
<emphasis role="strong"><literal>globus_simple_ca</literal></emphasis> package.</simpara>
<simpara>The default behavior of <emphasis role="strong"><literal>grid-cert-request</literal></emphasis> is to generate a
certificate request and private key for the user running the command.
The subject name is derived from the gecos information in the local
system&#8217;s password database, unless the <emphasis>-commonname</emphasis>, <emphasis>-cn</emphasis>, or <emphasis>-host</emphasis>
command-line options are used.</simpara>
<simpara>By default, <emphasis role="strong"><literal>grid-cert-request</literal></emphasis> writes user certificate requests
and keys to the <literal>$HOME/.globus</literal> directory, and host and service
certificate requests and keys to  directory, and host and service
certificate requests and keys to <literal>/etc/grid-security</literal>. This can be
overridden by using the . This can be overridden by using the <emphasis>-dir</emphasis>
command-line option.</simpara>
<simpara>The full set of command-line options to <emphasis role="strong"><literal>grid-cert-request</literal></emphasis> are:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong">-help, -h, -?, -usage</emphasis>
</term>
<listitem>
<simpara>
     Display the command-line options to <emphasis role="strong"><literal>grid-cert-request</literal></emphasis> and exit.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-version, -versions</emphasis>
</term>
<listitem>
<simpara>
     Display the version number of the <emphasis role="strong"><literal>grid-cert-request</literal></emphasis> command. The second form includes more details.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-cn <emphasis>NAME</emphasis>, -commonname <emphasis>NAME</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Create a certificate request with the common name component of the subject set to <emphasis>NAME</emphasis>. This is used to create user identity certificates.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-dir <emphasis>DIRECTORY</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Write the certificate request and key to files in the directory specified by <emphasis>DIRECTORY</emphasis>.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-prefix <emphasis>PREFIX</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Use the string <emphasis>PREFIX</emphasis> as the base name of the certificate, certificate_request, and key files instead of the default. For a user certificate request, this would mean creating files <literal>$HOME/.globus/PREFIXcert_request.pem</literal>, , <literal>$HOME/.globus/PREFIXcert.pem</literal>, and , and <literal>$HOME/.globus/PREFIXkey.pem</literal>..
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-ca <emphasis>CA-HASH</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Use the certificate request configuration for the CA with the name hash <emphasis>CA-HASH</emphasis> instead of the default CA chosen by running <emphasis role="strong"><literal>grid-default-ca</literal></emphasis>.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-verbose</emphasis>
</term>
<listitem>
<simpara>
     Keep the output from the OpenSSL certificate request command visible after it completes, instead of clearing the screen..
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-interactive, -int</emphasis>
</term>
<listitem>
<simpara>
     Prompt for each component of the subject name of the request, instead of generating the common name from other command-line options. Note that CAs may not sign certificates for subject names that don&#8217;t match their signing policies.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-force</emphasis>
</term>
<listitem>
<simpara>
     Overwrite any existing certificate request and private key with a new one.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-nopw, -nodes, -nopassphrase</emphasis>
</term>
<listitem>
<simpara>
     Create an unencrypted private key for the certificate instead of prompting for a passphrase. This is the default behavior for host or service certificates, but not recommended for user certificates.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-host <emphasis>FQDN</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Create a certificate request for use on a particular host. This option also causes the private key assoicated with the certificate request to be unencrypted. The <emphasis>FQDN</emphasis> argument to this option should be the fully qualified domain name of the host that will use this certificate. The subject name of the certificate will be derived from the <emphasis>FQDN</emphasis> and the service option if specified by the <emphasis>-service</emphasis> command-line option. If the host for the certificate has multiple names, then use either the <emphasis>-dns</emphasis> or <emphasis>-ip</emphasis> command-line options to add alternate names or addresses to the certificates.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-service <emphasis>SERVICE</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Create a certificate request for a particular service on a host. The subject name of the certificate will be derived from the <emphasis>FQDN</emphasis> passed as the argument to the <emphasis>-host</emphasis> command-line option and the <emphasis>SERVICE</emphasis> string.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-dns <emphasis>FQDN,&#8230;</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Create a certificate request containing a <literal>subjectAltName</literal> extension containing one or more host names. This is used when a certificate may be used by multiple virtual servers or if a host has different names when contacted within or outside a private network. Multiple DNS names can be included in the extension by separating then with a comma.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-ip <emphasis>IP-ADDRESS,&#8230;</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Create a certificate request containing a <literal>subjectAltName</literal> extension containing the IP addresses named by the <emphasis>IP-ADDRESS</emphasis> strings. This is used when a certificate may be used by services listening on multiple networks. Multiple IP addresses can be included in the extension by separating then with a comma.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_examples_3">
<title>Examples</title>
<simpara>Create a user certificate request:</simpara>
<screen>%  grid-cert-request
A certificate request and private key is being created.
You will be asked to enter a PEM pass phrase.
This pass phrase is akin to your account password,
and is used to protect your key file.
If you forget your pass phrase, you will need to
obtain a new certificate.
A private key and a certificate request has been generated with the subject:

/O=org/OU=example/OU=grid/CN=Joe User

If the CN=Joe User is not appropriate, rerun this
script with the -force -cn "Common Name" options.

Your private key is stored in /home/juser/.globus/userkey.pem
Your request is stored in /home/juser/.globus/usercert_request.pem

Please e-mail the request to the Example CA ca@grid.example.org
You may use a command similar to the following:

  cat /home/juser/.globus/usercert_request.pem | mail ca@grid.example.org

Only use the above if this machine can send AND receive e-mail. if not, please
mail using some other method.

Your certificate will be mailed to you within two working days.
If you receive no response, contact Example CA at ca@grid.example.org</screen>
<simpara>Create a host certificate for a host with two names.</simpara>
<screen>%  grid-cert-request -host grid.example.org -dns grid.example.org,grid-internal.example.org

A private host key and a certificate request has been generated
with the subject:

/O=org/OU=example/OU=grid/CN=host/grid.example.org

 ----------------------------------------------------------

The private key is stored in /etc/grid-security/hostkey.pem
The request is stored in /etc/grid-security/hostcert_request.pem

Please e-mail the request to the Example CA ca@grid.example.org
You may use a command similar to the following:

 cat /etc/grid-security/hostcert_request.pem | mail ca@grid.example.org

Only use the above if this machine can send AND receive e-mail. if not, please
mail using some other method.

Your certificate will be mailed to you within two working days.
If you receive no response, contact Example CA at
ca@grid.example.org</screen>
</section>
<section id="_environment_variables_2">
<title>Environment Variables</title>
<simpara>The following environment variables affect the execution of
<emphasis role="strong"><literal>grid-cert-request</literal></emphasis>:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong"><literal>X509_CERT_DIR</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the directory containing SSL configuration files for generating certificate requests.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong"><literal>GRID_SECURITY_DIR</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the directory containing SSL configuration files for generating certificate requests. This value is used if <literal>X509_CERT_DIR</literal> is not set.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong"><literal>GLOBUS_LOCATION</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the directory containing the Globus Toolkit. This is searched if neither the <literal>X509_CERT_DIR</literal> nor the <literal>GRID_SECURITY_DIR</literal> environment variables are set.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_files">
<title>Files</title>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong"><literal>$HOME/.globus/usercert_request.pem</literal></emphasis>
</term>
<listitem>
<simpara>
     Default path to write a user certificate request.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong"><literal>$HOME/.globus/usercert.pem</literal></emphasis>
</term>
<listitem>
<simpara>
     Default path to write a user certificate.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong"><literal>$HOME/.globus/userkey.pem</literal></emphasis>
</term>
<listitem>
<simpara>
     Default path to write a user private key.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong"><literal>/etc/grid-security/hostcert_request.pem</literal></emphasis>
</term>
<listitem>
<simpara>
     Default path to write a host certificate request.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong"><literal>/etc/grid-security/hostcert.pem</literal></emphasis>
</term>
<listitem>
<simpara>
     Default path to write a host certificate.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong"><literal>/etc/grid-security/hostkey.pem</literal></emphasis>
</term>
<listitem>
<simpara>
     Default path to write a host private key.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong"><literal>TRUSTED-CERT-DIR/globus-user-ssl.conf</literal>, <literal>TRUSTED-CERT-DIR/globus-user-ssl.conf.CA-HASH</literal></emphasis>
</term>
<listitem>
<simpara>
     SSL configuration file for requesting a user certificate. The first form is the default location, the second form is used when the <emphasis>-ca</emphasis> command-line option is specified.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong"><literal>TRUSTED-CERT-DIR/globus-host-ssl.conf</literal>, <literal>TRUSTED-CERT-DIR/globus-host-ssl.conf.CA-HASH</literal></emphasis>
</term>
<listitem>
<simpara>
     SSL configuration file for requesting a host or service certificate. The first form is the default location, the second form is used when the <emphasis>-ca</emphasis> command-line option is specified.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
</section>
<section id="grid-default-ca">
<title>GRID-DEFAULT-CA(8)</title>
<section id="_name_5">
<title>NAME</title>
<simpara>grid-default-ca - Select default CA for certificate requests</simpara>
</section>
<section id="_synopsis_5">
<title>SYNOPSIS</title>
<simpara><emphasis role="strong"><literal>grid-default-ca</literal></emphasis> [<literal>-help</literal> ] [<literal>-h</literal> ] [<literal>-usage</literal> ] [<literal>-u</literal> ] [<literal>-version</literal> ] [<literal>-versions</literal> ]</simpara>
</section>
<section id="_description_5">
<title>Description</title>
<simpara>The <emphasis role="strong"><literal>grid-default-ca</literal></emphasis> program sets the default certificate
authority to use when the <emphasis role="strong"><literal>grid-cert-request</literal></emphasis> script is run. The
CA&#8217;s certificate, configuration, and signing policy must be installed in
the trusted certificate directory to be able to request certificates
from that CA. Note that some CAs have different policies and use other
tools to handle certificate requests. Please consult your CA&#8217;s support
staff if you unsure. The <emphasis role="strong"><literal>grid-default-ca</literal></emphasis> is designed to work
with CAs implemented using the <emphasis role="strong"><literal>globus_simple_ca</literal></emphasis> package.</simpara>
<simpara>By default, the <emphasis role="strong"><literal>grid-default-ca</literal></emphasis> program displays a list of
installed CA certificates and the prompts the user for which one to set
as the default. If invoked with the <emphasis>-list</emphasis> command-line option,
<emphasis role="strong"><literal>grid-default-ca</literal></emphasis> will print the list and not prompt nor set the
default CA. If invoked with the <emphasis>-ca</emphasis> option, it will not list or
prompt, but set the default CA to the one with the hash that matches the
<emphasis>CA-HASH</emphasis> argument to that option. If <emphasis role="strong"><literal>grid-default-ca</literal></emphasis> is used to
set the default CA, the caller of this program must have write
permissions to the trusted certificate directory.</simpara>
<simpara>The <emphasis role="strong"><literal>grid-default-ca</literal></emphasis> program sets the CA in the one of the grid
security directories. It looks in the directory named by the
<literal>GRID_SECURITY_DIR</literal> environment, the <literal>X509_CERT_DIR</literal>,
<literal>/etc/grid-security</literal>, and , and
<literal>$GLOBUS_LOCATION/share/certificates</literal>. .</simpara>
<simpara>The full set of command-line options to <emphasis role="strong"><literal>grid-default-ca</literal></emphasis> are:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong">-help, -h, -usage, -u</emphasis>
</term>
<listitem>
<simpara>
     Display the command-line options to <emphasis role="strong"><literal>grid-default-ca</literal></emphasis> and exit.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-version, -versions</emphasis>
</term>
<listitem>
<simpara>
     Display the version number of the <emphasis role="strong"><literal>grid-default-ca</literal></emphasis> command. The second form includes more details.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-dir <emphasis>CA-DIRECTORY</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Use the trusted certificate directory named by <emphasis>CA-DIRECTORY</emphasis> instead of the default.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-list</emphasis>
</term>
<listitem>
<simpara>
     Instead of changing the default CA, print out a list of all available CA certificates in the trusted certificate directory
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-ca <emphasis>CA-HASH</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Set the default CA without displaying the list of choices or prompting. The CA file named by <emphasis>CA-HASH</emphasis> must exist.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_examples_4">
<title>Examples</title>
<simpara>List the contents of the trusted certificate directory that contain the
string Example:</simpara>
<screen>%  grid-default-ca | grep Example
15) cd1186ff -  /DC=org/DC=Example/DC=Grid/CN=Example CA</screen>
<simpara>Choose that CA as the default:</simpara>
<screen>%  grid-default-ca -ca cd1186ff

setting the default CA to: /DC=org/DC=Example/DC=Grid/CN=Example CA

linking /etc/grid-security/certificates/grid-security.conf.cd1186ff to
        /etc/grid-security/certificates/grid-security.conf

linking /etc/grid-security/certificates/grid-host-ssl.conf.cd1186ff  to
        /etc/grid-security/certificates/grid-host-ssl.conf

linking /etc/grid-security/certificates/grid-user-ssl.conf.cd1186ff  to
        /etc/grid-security/certificates/grid-user-ssl.conf

...done.</screen>
</section>
<section id="_environment_variables_3">
<title>Environment Variables</title>
<simpara>The following environment variables affect the execution of
<emphasis role="strong"><literal>grid-default-ca</literal></emphasis>:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong"><literal>GRID_SECURITY_DIRECTORY</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the default trusted certificate directory.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong"><literal>X509_CERT_DIR</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the default trusted certificate directory.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong"><literal>GLOBUS_LOCATION</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the Globus Toolkit installation directory.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_bugs">
<title>Bugs</title>
<simpara>The <emphasis role="strong"><literal>grid-default-ca</literal></emphasis> program displays CAs from all of the
directories in its search list; however, <emphasis role="strong"><literal>grid-cert-request</literal></emphasis> only
uses the first which contains a grid security configuration.</simpara>
<simpara>The <emphasis role="strong"><literal>grid-default-ca</literal></emphasis> program may display the same CA multiple
times if it is located in multiple directories in its search path.
However, it does not provide any information about which one would
actually be used by the <emphasis role="strong"><literal>grid-cert-request</literal></emphasis> command.</simpara>
</section>
<section id="_see_also">
<title>See Also</title>
<simpara><literal>grid-cert-request(1)</literal></simpara>
</section>
</section>
<section id="grid-change-pass-phrase">
<title>GRID-CHANGE-PASS-PHRASE(1)</title>
<section id="_name_6">
<title>NAME</title>
<simpara>grid-change-pass-phrase - Change the passphrase of a private key</simpara>
</section>
<section id="_synopsis_6">
<title>SYNOPSIS</title>
<simpara><emphasis role="strong"><literal>grid-change-pass-phrase</literal></emphasis> [<literal>-help</literal> ] [<literal>-usage</literal> ] [<literal>-version</literal> ] [<literal>-versions</literal> ]</simpara>
</section>
<section id="_description_6">
<title>Description</title>
<simpara>The <emphasis role="strong"><literal>grid-change-pass-phrase</literal></emphasis> program changes the passphrase
protecting a private key or PKCS12 bundle containing a private key and
certificate. By default, <emphasis role="strong"><literal>grid-change-pass-phrase</literal></emphasis> uses the
<literal>X509_USER_KEY</literal> environment variable to locate the private key. If
that is not set, then it looks for <literal>$HOME/.globus/userkey.pem</literal> and
and <literal>$HOME/.globus/usercred.p12</literal> in succession. The path to a key can
be specified by using the  in succession. The path to a key can be
specified by using the <emphasis>-file</emphasis> command-line option.</simpara>
<simpara>The full set of command-line options to <emphasis role="strong"><literal>grid-change-pass-phrase</literal></emphasis>
are:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong">-help, -usage</emphasis>
</term>
<listitem>
<simpara>
     Display the command-line options to <emphasis role="strong"><literal>grid-change-pass-phrase</literal></emphasis> and exit.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-version, -versions</emphasis>
</term>
<listitem>
<simpara>
     Display the version number of the <emphasis role="strong"><literal>grid-change-pass-phrase</literal></emphasis> command. The second form includes more details.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-file <emphasis>PRIVATE-KEY</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Change the passphrase of the private key named by <emphasis>PRIVATE-KEY</emphasis> instead of the default.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_examples_5">
<title>Examples</title>
<simpara>Change the passphrase of the default private key:</simpara>
<screen>%  grid-change-pass-phrase

Enter pass phrase for /home/juser/.globus/userkey.pem:
writing RSA key
Enter PEM pass phrase:
Verifying - Enter PEM pass phrase:</screen>
</section>
<section id="_environment_variables_4">
<title>Environment Variables</title>
<simpara>The following environment variables affect the execution of
<emphasis role="strong"><literal>grid-change-pass-phrase</literal></emphasis>:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong"><literal>X509_USER_KEY</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the default private key file.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
</section>
<section id="grid-proxy-init">
<title>GRID-PROXY-INIT(1)</title>
<section id="_name_7">
<title>NAME</title>
<simpara>grid-proxy-init - Generate a new proxy certificate</simpara>
</section>
<section id="_synopsis_7">
<title>SYNOPSIS</title>
<simpara><emphasis role="strong"><literal>grid-proxy-init</literal></emphasis> [<literal>-help</literal> ] [<literal>-usage</literal> ] [<literal>-version</literal> ]</simpara>
</section>
<section id="_description_7">
<title>Description</title>
<simpara>The <emphasis role="strong"><literal>grid-proxy-init</literal></emphasis> program generates X.509 proxy certificates
derived from the currently available certificate files. By default, this
command generates a <ulink url="http://www.ietf.org/rfc/rfc3820.txt">RFC 3820</ulink> Proxy
Certificate with a 512 bit key valid for 12 hours in a file named
<literal>/tmp/x509up_uUID</literal>. Command-line options and variables can modify the
format, strength, lifetime, and location of the generated proxy
certificate. . Command-line options and variables can modify the format,
strength, lifetime, and location of the generated proxy certificate.</simpara>
<simpara>X.509 proxy certificates are short-lived certificates, signed usually by
a user&#8217;s identity certificate or another proxy certificate. The key
associated with a proxy certificate is unencrypted, so applications can
authenticate using a proxy identity without providing a passphrase.</simpara>
<simpara>Proxy certificates provide a convenient alternative to constantly
entering passwords, but are also less secure than the user&#8217;s normal
security credential. Therefore, they should always be user-readable only
(this is enforced by the GSI libraries), and should be deleted after
they are no longer needed.</simpara>
<simpara>This version of <emphasis role="strong"><literal>grid-proxy-init</literal></emphasis> supports three different proxy
formats: the old proxy format used in early releases of the Globus
Toolkit up to version 2.4.x, an IETF draft version of X.509 Proxy
Certificate profile used in Globus Toolkit 3.0.x and 3.2.x, and the RFC
3820 profile used in Globus Toolkit Version 4.0.x and 4.2.x. By default,
this version of <emphasis role="strong"><literal>grid-proxy-init</literal></emphasis> creates an RFC 3820 compliant
proxy. To create a proxy compatible with older versions of the Globus
Toolkit, use the <emphasis>-old</emphasis> or <emphasis>-draft</emphasis> command-line options.</simpara>
<simpara>The full set of command-line options to <emphasis role="strong"><literal>grid-proxy-init</literal></emphasis> are:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong">-help, -usage</emphasis>
</term>
<listitem>
<simpara>
     Display the command-line options to <emphasis role="strong"><literal>grid-proxy-init</literal></emphasis>.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-version</emphasis>
</term>
<listitem>
<simpara>
     Display the version number of the <emphasis role="strong"><literal>grid-proxy-init</literal></emphasis> command
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-debug</emphasis>
</term>
<listitem>
<simpara>
     Display information about the path to the certificate and key used to generate the proxy certificate, the path to the trusted certificate directory, and verbose error messages
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-q</emphasis>
</term>
<listitem>
<simpara>
     Suppress all output from <emphasis role="strong"><literal>grid-proxy-init</literal></emphasis> except for passphrase prompts.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-verify</emphasis>
</term>
<listitem>
<simpara>
     Perform certificate chain validity checks on the generated proxy.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-valid <emphasis>HOURS</emphasis>:'MINUTES', -hours <emphasis>HOURS</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Create a certificate that is valid for <emphasis>HOURS</emphasis> hours and <emphasis>MINUTES</emphasis> minutes. If not specified, the default of twelve hours and no minutes is used.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-cert <emphasis>CERTFILE</emphasis>, -key <emphasis>KEYFILE</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Create a proxy certificate signed by the certificate located in <literal>CERTFILE</literal> using the key located in  using the key located in <literal>KEYFILE</literal>. If not specified the default certificate and key will be used. This overrides the values of environment variables described below.. If not specified the default certificate and key will be used. This overrides the values of environment variables described below.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-certdir <emphasis>CERTDIR</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Search <emphasis>CERTDIR</emphasis> for trusted certificates if verifying the proxy certificate. If not specified, the default trusted certificate search path is used. This overrides the value of the <literal>X509_CERT_DIR</literal> environment variable
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-out <emphasis>PROXYPATH</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Write the generated proxy certificate file to <emphasis>PROXYPATH</emphasis> instead of the default path of <literal>/tmp/x509up_uUID</literal>..
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-bits <emphasis>BITS</emphasis></emphasis>
</term>
<listitem>
<simpara>
     When creating the proxy certificate, use a <emphasis>BITS</emphasis> bit key instead of the default 512 bit keys.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-policy <emphasis>POLICYFILE</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Add the certificate policy data described in <emphasis>POLICYFILE</emphasis> as the ProxyCertInfo X.509 extension to the generated proxy certificate.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-pl <emphasis>POLICY-OID</emphasis>, -policy-language <emphasis>POLICY-OID</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Set the policy language identifier of the policy data specified by the <emphasis>-policy</emphasis> command-line option to the oid specified by the <emphasis>POLICY-OID</emphasis> string.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-path-length <emphasis>MAXIMUM</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Set the maximum length of the chain of proxies that can be created by the generated proxy to <emphasis>MAXIMUM</emphasis>. If not set, the default of an unlimited proxy chain length is used.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-pwstdin</emphasis>
</term>
<listitem>
<simpara>
     Read the private key&#8217;s passphrase from stdin instead of reading input from the controlling tty. This is useful when scripting <emphasis role="strong"><literal>grid-proxy-init</literal></emphasis>.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-limited</emphasis>
</term>
<listitem>
<simpara>
     Create a limited proxy. Limited proxies are generally refused by process-creating services, but may be used to authorize with other services.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-independent</emphasis>
</term>
<listitem>
<simpara>
     Create an independent proxy. An independent proxy is not treated as an impersonation proxy but as a separate identity for authorization purposes.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-draft</emphasis>
</term>
<listitem>
<simpara>
     Create a IETF draft proxy instead of the default RFC 3280-compliant proxy. This type of proxy uses a non-standard proxy policy identifier. This might be useful for authenticating with older versions of the Globus Toolkit.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-old</emphasis>
</term>
<listitem>
<simpara>
     Create a legacy proxy instead of the default RFC 3280-compliant proxy. This type of proxy uses a non-standard method of indicating that the certificate is a proxy and whether it is limited. This might be useful for authenticating with older versions of the Globus Toolkit.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-rfc</emphasis>
</term>
<listitem>
<simpara>
     Create an RFC 3820-compliant proxy certificate. This is the default for this version of <emphasis role="strong"><literal>grid-proxy-init</literal></emphasis>.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_examples_6">
<title>Examples</title>
<simpara>To create a proxy with the default lifetime and format, run the
<emphasis role="strong"><literal>grid-proxy-init</literal></emphasis> program with no arguments. For example:</simpara>
<screen>%  grid-proxy-init
Your identity: /DC=org/DC=example/CN=Joe User
Enter GRID pass phrase for this identity: Creating proxy .................................. Done
Your proxy is valid until: Thu Mar 18 03:48:05 2010</screen>
<simpara>To create a stronger proxy that lasts for only 8 hours, use the <emphasis>-hours</emphasis>
and <emphasis>-bits</emphasis> command-line options to <emphasis role="strong"><literal>grid-proxy-init</literal></emphasis>. For
example:</simpara>
<screen>%  grid-proxy-init -hours 8 -bits 1024
Your identity: /DC=org/DC=example/CN=Joe User
Enter GRID pass phrase for this identity: Creating proxy .................................. Done
Your proxy is valid until: Thu Mar 17 23:48:05 2010</screen>
</section>
<section id="_environment_variables_5">
<title>Environment Variables</title>
<simpara>The following environment variables affect the execution of
<emphasis role="strong"><literal>grid-proxy-init</literal></emphasis>:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong"><literal>X509_USER_CERT</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the certificate to use as issuer of the new proxy.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong"><literal>X509_USER_KEY</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the key to use to sign the new proxy.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong"><literal>X509_CERT_DIR</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the directory containing trusted certifiate certificates and signing policies.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_files_2">
<title>Files</title>
<simpara>The following files affect the execution of <emphasis role="strong"><literal>grid-proxy-init</literal></emphasis>:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong"><literal>$HOME/.globus/usercert.pem</literal></emphasis>
</term>
<listitem>
<simpara>
     Default path to the certificate to use as issuer of the new proxy.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong"><literal>$HOME/.globus/userkey.pem</literal></emphasis>
</term>
<listitem>
<simpara>
     Default path to the key to use to sign the new proxy.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_compatibility">
<title>Compatibility</title>
<simpara>For more information about proxy certificate types and their
compatibility in GT, see
<ulink url="http://dev.globus.org/wiki/Security/ProxyCertTypes">http://dev.globus.org/wiki/Security/ProxyCertTypes</ulink>.</simpara>
</section>
<section id="_see_also_2">
<title>See Also</title>
<simpara><literal>grid-proxy-destroy(1)</literal>, <literal>grid-proxy-info(1)</literal></simpara>
</section>
</section>
<section id="grid-proxy-destroy">
<title>GRID-PROXY-DESTROY(1)</title>
<section id="_name_8">
<title>NAME</title>
<simpara>grid-proxy-destroy - Destroy the default proxy certificate</simpara>
</section>
<section id="_synopsis_8">
<title>SYNOPSIS</title>
<simpara><emphasis role="strong"><literal>grid-proxy-destroy</literal></emphasis> [<literal>-help</literal> ] [<literal>-usage</literal> ] [<literal>-version</literal> ]</simpara>
</section>
<section id="_description_8">
<title>Description</title>
<simpara>The <emphasis role="strong"><literal>grid-proxy-destroy</literal></emphasis> program removes X.509 proxy files from
the local filesystem. It overwrites the data in the files and removes
the files from the filesystem. By default, it removes the current user&#8217;s
default proxy (either <literal>/tmp/x509up_uUID</literal> where  where <emphasis>UID</emphasis> is the
current POSIX user id, or the file pointed to by the <literal>X509_USER_PROXY</literal>
environment variable) unless a list of proxy file paths are included as
part of the command line.</simpara>
<simpara>Use the <literal>--</literal> command-line option to separate a list of proxy paths
from command line options if the proxy file begins with the <literal>-</literal>
character.</simpara>
<simpara>The full list of command-line options to <emphasis role="strong"><literal>grid-proxy-destroy</literal></emphasis> are:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong">-help, -usage</emphasis>
</term>
<listitem>
<simpara>
     Display the command-line options to <emphasis role="strong"><literal>grid-proxy-destroy</literal></emphasis>.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-version</emphasis>
</term>
<listitem>
<simpara>
     Display the version number of the <emphasis role="strong"><literal>grid-proxy-destroy</literal></emphasis> command
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-debug</emphasis>
</term>
<listitem>
<simpara>
     Display verbose error messages.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-dryrun</emphasis>
</term>
<listitem>
<simpara>
     Do not remove the proxy, but display the path of the files that would have been removed, or the directory where they would have been removed from if the <emphasis>-all</emphasis> command-line option is used.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-default</emphasis>
</term>
<listitem>
<simpara>
     Remove the default proxy in addition to the files included on the command-line. Only needed if other paths are included on the command-line.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-all</emphasis>
</term>
<listitem>
<simpara>
     Remove the default proxy and all delegated proxies in the temporary file directory.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_environment_variables_6">
<title>Environment Variables</title>
<simpara>The following environment variables affect the execution of
<emphasis role="strong"><literal>grid-proxy-destroy</literal></emphasis>:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong"><literal>X509_USER_PROXY</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the default user proxy.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_see_also_3">
<title>See Also</title>
<simpara><literal>grid-proxy-init(1)</literal>, <literal>grid-proxy-info(1)</literal></simpara>
</section>
</section>
<section id="grid-proxy-info">
<title>GRID-PROXY-INFO(1)</title>
<section id="_name_9">
<title>NAME</title>
<simpara>grid-proxy-info - Display information about a proxy certificate</simpara>
</section>
<section id="_synopsis_9">
<title>SYNOPSIS</title>
<simpara><emphasis role="strong"><literal>grid-proxy-info</literal></emphasis> [<literal>-help</literal> ] [<literal>-usage</literal> ] [<literal>-version</literal> ]</simpara>
</section>
<section id="_description_9">
<title>Description</title>
<simpara>The <emphasis role="strong"><literal>grid-proxy-info</literal></emphasis> program extracts information from an X.509
proxy certificates, and optionally displays or returns an exit code
based on that information.</simpara>
<simpara>The default mode of operation is to print the following facts about the
current user&#8217;s default proxy: subject, issuer, identity, type, strength,
path, and time left. If the command-line option <emphasis>-exists</emphasis> or <emphasis>-e</emphasis> is
included in the command-line, nothing is printed unless one of the print
options is specified. Instead, <emphasis role="strong"><literal>grid-proxy-info</literal></emphasis> determines if a
valid proxy exists and, if so, exits with the exit code <literal>0</literal>; if a
proxy does not exist or is not valid, <emphasis role="strong"><literal>grid-proxy-info</literal></emphasis> exits with
the exit code <literal>1</literal>. Additional validity criteria can be added by using
the <emphasis>-valid</emphasis>, <emphasis>-v</emphasis>, <emphasis>-hours</emphasis>, <emphasis>-h</emphasis>, <emphasis>-bits</emphasis>, or <emphasis>-b</emphasis> command-line
options. If used, these options must occur <emphasis role="strong">after</emphasis> the <emphasis>-e</emphasis> or
<emphasis>-exists</emphasis> command-line options. Those options are only valid if one of
the <emphasis>-e</emphasis> or <emphasis>-exists</emphasis> command-line options is used.</simpara>
<simpara>The complete set of command-line options to <emphasis role="strong"><literal>grid-proxy-info</literal></emphasis> are:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong">-help, -usage</emphasis>
</term>
<listitem>
<simpara>
     Display the command-line options to <emphasis role="strong"><literal>grid-proxy-info</literal></emphasis>.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-version</emphasis>
</term>
<listitem>
<simpara>
     Display the version number of the <emphasis role="strong"><literal>grid-proxy-info</literal></emphasis> command
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-debug</emphasis>
</term>
<listitem>
<simpara>
     Display verbose error messages.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-file <emphasis>PROXYFILE</emphasis>, -f <emphasis>PROXYFILE</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Read the proxy located in the file <emphasis>PROXYFILE</emphasis> instead of using the default proxy.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-subject, -s</emphasis>
</term>
<listitem>
<simpara>
     Display the proxy certificate&#8217;s subject distinguished name.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-issuer, -i</emphasis>
</term>
<listitem>
<simpara>
     Display the proxy certificate issuer&#8217;s distinguished name.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-identity</emphasis>
</term>
<listitem>
<simpara>
     Display the proxy certificate&#8217;s identity. For non-independent proxies, the identity is the subject of the certificate which issued the first proxy in the proxy chain.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-type</emphasis>
</term>
<listitem>
<simpara>
     Display the type of proxy certificate. The type string includes the format ("legacy", "draft", or RFC 3280 compliant), identity type ("impersonation" or "independent"), and policy ("limited" or "full"). See <literal>grid-proxy-init(1)</literal> for information about how to create different types of proxies.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-timeleft</emphasis>
</term>
<listitem>
<simpara>
     Display the number of seconds remaining until the proxy certificate expires.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-strength</emphasis>
</term>
<listitem>
<simpara>
     Display the strength (in bits) of the key associated with the proxy certificate.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-all</emphasis>
</term>
<listitem>
<simpara>
     Display the default information for the proxy when also using the <emphasis>-e</emphasis> or <emphasis>-exists</emphasis> command-line option.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-text</emphasis>
</term>
<listitem>
<simpara>
     Display the proxy certificate contents to standard output, including policy information, issuer, public key, and modulus.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-path</emphasis>
</term>
<listitem>
<simpara>
     Display the path to the file containing the default proxy certificate.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-rfc2253</emphasis>
</term>
<listitem>
<simpara>
     Display distinguished names for the subject, issuer, and identity using the string representation described in RFC 2253, instead of the legacy format.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-exists, -e</emphasis>
</term>
<listitem>
<simpara>
     Perform an existence and validity check for the proxy. If a valid proxy exists and matches the criteria described by other command-line options (if any), exit with 0; otherwise, exit with 1. This option must be before other validity check predicate in the command-line options. If this option is specified, the output of the default facts about the proxy is disabled. Use the <emphasis>-all</emphasis> option to have the information displayed as well as the exit code set.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-valid <emphasis>HOURS</emphasis>:'MINUTES', -v <emphasis>HOURS</emphasis>:'MINUTES', -hours <emphasis>HOURS</emphasis>, -h <emphasis>HOURS</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Check that the proxy certificate is valid for at least <emphasis>HOURS</emphasis> hours and <emphasis>MINUTES</emphasis> minutes. If it is not, <emphasis role="strong"><literal>grid-proxy-info</literal></emphasis> will exit with exit code <literal>1</literal>.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-bits <emphasis>BITS</emphasis>, -b <emphasis>BITS</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Check that the proxy certificate key strength is at least <emphasis>BITS</emphasis> bits.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_environment_variables_7">
<title>Environment Variables</title>
<simpara>The following environment variables affect the execution of
<emphasis role="strong"><literal>grid-proxy-info</literal></emphasis>:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong"><literal>X509_USER_PROXY</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the default user proxy.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_see_also_4">
<title>See Also</title>
<simpara><literal>grid-proxy-init(1)</literal>, <literal>grid-proxy-destroy(1)</literal></simpara>
</section>
</section>
<section id="grid-mapfile-add-entry">
<title>GRID-MAPFILE-ADD-ENTRY(8)</title>
<section id="_name_10">
<title>NAME</title>
<simpara>grid-mapfile-add-entry - Add an entry to a gridmap file</simpara>
</section>
<section id="_synopsis_10">
<title>SYNOPSIS</title>
<simpara><emphasis role="strong"><literal>grid-mapfile-add-entry</literal></emphasis> [<literal>-help</literal> ] [<literal>-usage</literal> ] [<literal>-version</literal> ] [<literal>-versions</literal> ]</simpara>
</section>
<section id="_description_10">
<title>Description</title>
<simpara>The <emphasis role="strong"><literal>grid-mapfile-add-entry</literal></emphasis> program adds a new mapping from an
X.509 distinguished name to a local POSIX user name to a gridmap file.
Gridmap files are used as a simple authorization method for services
such as GRAM5 or GridFTP.</simpara>
<simpara>The <emphasis role="strong"><literal>grid-mapfile-add-entry</literal></emphasis> program verifies that the
<emphasis>LOCAL-NAME</emphasis> is a valid user name on the system on which it was run, and
that the mapping between <emphasis>DISTINGUISHED-NAME</emphasis> and <emphasis>LOCAL-NAME</emphasis> does not
already exist in the gridmap file.</simpara>
<simpara>By default, <emphasis role="strong"><literal>grid-mapfile-add-entry</literal></emphasis> will modify the gridmap file
named by the <literal>GRIDMAP</literal> environment variable if present, or the file
<literal>/etc/grid-security/grid-mapfile</literal> if not. This can be changed by the
use of the  if not. This can be changed by the use of the <emphasis>-mapfile</emphasis> or
<emphasis>-f</emphasis> command-line options.</simpara>
<simpara>If the gridmap file does not exist, <emphasis role="strong"><literal>grid-mapfile-add-entry</literal></emphasis> will
create it. If it already exists, <emphasis role="strong"><literal>grid-mapfile-add-entry</literal></emphasis> will
save the current contents of the file to a new file with the string
<literal>.old</literal> appended to the file name.</simpara>
<simpara>The full set of command-line options to <emphasis role="strong"><literal>grid-mapfile-add-entry</literal></emphasis>
are:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong">-help, -usage</emphasis>
</term>
<listitem>
<simpara>
     Display the command-line options to <emphasis role="strong"><literal>grid-mapfile-add-entry</literal></emphasis>.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-version, -versions</emphasis>
</term>
<listitem>
<simpara>
     Display the version number of the <emphasis role="strong"><literal>grid-mapfile-add-entry</literal></emphasis> command. The second form includes more details.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-dn <emphasis>DISTINGUISHED-NAME</emphasis></emphasis>
</term>
<listitem>
<simpara>
     The X.509 distinguished name to add a mapping for. The name should be in OpenSSL&#8217;s <literal>oneline</literal> format.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-ln <emphasis>LOCAL-NAME</emphasis>&#8230;</emphasis>
</term>
<listitem>
<simpara>
     The POSIX user name to map the distinguished name to. This name must be a valid username. Add multiple <emphasis>LOCAL-NAME</emphasis> strings after the <emphasis>-ln</emphasis> command-line option. If any of the local names are invalid, no changes will be made to the gridmap file. Note that if multiple occurances of the <emphasis>-ln</emphasis> command-line option are present, only the the last one will be added.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-d, -dryrun</emphasis>
</term>
<listitem>
<simpara>
     Verify local names and display diagnostics about what would be added to the gridmap file, but don&#8217;t actually modify the file.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-mapfile <emphasis>MAPFILE</emphasis>, -f <emphasis>MAPFILE</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Modify the gridmap file named by <emphasis>MAPFILE</emphasis> instead of the default.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_examples_7">
<title>Examples</title>
<simpara>Add a mapping between the current user&#8217;s certificate to the current user
id to a gridmap file in <literal>$HOME/.gridmap</literal>: :</simpara>
<screen>%  grid-mapfile-add-entry -f $HOME/.gridmap -dn "`grid-cert-info -subject`" -ln "`id -un`"
Modifying /home/juser/.gridmap ...
/home/juser/.gridmap does not exist... Attempting to create /home/juser/.gridmap
New entry:
"/DC=org/DC=example/DC=grid/CN=Joe User" juser
(1) entry added</screen>
<simpara>Add a mapping between the a distinguished name and multiple local names:</simpara>
<screen>%  grid-mapfile-add-entry -dn "/DC=org/DC=example/DC=grid/CN=Joe User" juser" local1 local2
Modifying /home/juser/.gridmap ...
/home/juser/.gridmap does not exist... Attempting to create /home/juser/.gridmap
New entry:
"/DC=org/DC=example/DC=grid/CN=Joe User" local1,local2
(1) entry added</screen>
</section>
<section id="_environment_variables_8">
<title>Environment Variables</title>
<simpara>The following environment variables affect the execution of
<emphasis role="strong"><literal>grid-mapfile-add-entry</literal></emphasis>:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong"><literal>GRIDMAP</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the default gridmap to modify.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_files_3">
<title>Files</title>
<simpara>The following files affect the execution of
<emphasis role="strong"><literal>grid-mapfile-add-entry</literal></emphasis>:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong"><literal>/etc/grid-security/grid-mapfile</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the default gridmap to modify if <literal>GRIDMAP</literal> environment variable is not set.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_see_also_5">
<title>See Also</title>
<simpara><literal>grid-mapfile-check-consistency(8)</literal>, <literal>grid-mapfile-delete-entry(8)</literal></simpara>
</section>
</section>
<section id="grid-mapfile-check-consistency">
<title>GRID-MAPFILE-CHECK-CONSISTENCY(8)</title>
<section id="_name_11">
<title>NAME</title>
<simpara>grid-mapfile-check-consistency - Add an entry to a grid map file</simpara>
</section>
<section id="_synopsis_11">
<title>SYNOPSIS</title>
<simpara><emphasis role="strong"><literal>grid-mapfile-check-consistency</literal></emphasis> [<literal>-h</literal> ] [<literal>-help</literal> ] [<literal>-usage</literal> ] [<literal>-version</literal> ]</simpara>
</section>
<section id="_description_11">
<title>Description</title>
<simpara>The <emphasis role="strong"><literal>grid-mapfile-check-consistency</literal></emphasis> program performs basic checks
for validity of a gridmap file. These checks include checks for
existence, duplication of entries, and valid local user names. If the
gridmap file is valid, <emphasis role="strong"><literal>grid-mapfile-check-consistency</literal></emphasis> exits with
a zero exit code, otherwise it exits with a non-zero exit code. In
either case, it displays information about its progress as it parses and
validates the gridmap file.</simpara>
<simpara>By default, <emphasis role="strong"><literal>grid-mapfile-check-consistency</literal></emphasis> will check the
gridmap file named by the <literal>GRIDMAP</literal> environment variable if present.
If that variable is not set, it will check the file <literal>$HOME/.gridmap</literal>
for non-root users if present. If that doesn&#8217;t exist or  for non-root
users if present. If that doesn&#8217;t exist or
<emphasis role="strong"><literal>grid-mapfile-check-consistency</literal></emphasis> is run as root, it will then
check <literal>/etc/grid-security/grid-mapfile</literal>. This can be changed by the
use of the . This can be changed by the use of the <emphasis>-mapfile</emphasis> or <emphasis>-f</emphasis>
command-line options.</simpara>
<simpara>The full set of command-line options to
<emphasis role="strong"><literal>grid-mapfile-check-consistency</literal></emphasis> are:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong">-help, -h, -usage</emphasis>
</term>
<listitem>
<simpara>
     Display the command-line options to <emphasis role="strong"><literal>grid-mapfile-check-consistency</literal></emphasis>.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-version</emphasis>
</term>
<listitem>
<simpara>
     Display the version number of the <emphasis role="strong"><literal>grid-mapfile-check-consistency</literal></emphasis> command.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-mapfile <emphasis>MAPFILE</emphasis>, -f <emphasis>MAPFILE</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Check the gridmap file named by <emphasis>MAPFILE</emphasis> instead of the default.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_examples_8">
<title>Examples</title>
<simpara>Check that the gridmap file in <literal>/etc/grid-security</literal> is valid:  is
valid:</simpara>
<screen>%  grid-mapfile-check-consistency -f /etc/grid-security/grid-mapfile
Checking /etc/grid-security/grid-mapfile
Verifying grid mapfile existence...OK
Checking for duplicate entries...OK
Checking for valid user names...OK</screen>
<simpara>Check a gridmap file that has an invalid local user name:</simpara>
<screen>%  grid-mapfile-check-consistency -f /etc/grid-security/grid-mapfile
Checking /etc/grid-security/grid-mapfile
Verifying grid mapfile existence...OK
Checking for duplicate entries...OK
ERROR: baduser is not a valid local username
ERROR: Found 1 invalid username(s)</screen>
</section>
<section id="_environment_variables_9">
<title>Environment Variables</title>
<simpara>The following environment variables affect the execution of
<emphasis role="strong"><literal>grid-mapfile-check-consistency</literal></emphasis>:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong"><literal>GRIDMAP</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the default gridmap to check.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_files_4">
<title>Files</title>
<simpara>The following files affect the execution of
<emphasis role="strong"><literal>grid-mapfile-check-consistency</literal></emphasis>:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong"><literal>$HOME/.gridmap</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the default gridmap to check if the <literal>GRIDMAP</literal> environment variable is not set for non-root users.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong"><literal>/etc/grid-security/grid-mapfile</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the default gridmap to check if <literal>GRIDMAP</literal> environment variable is not set and the above file does not exist.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_see_also_6">
<title>See Also</title>
<simpara><literal>grid-mapfile-add-entry(8)</literal>, <literal>grid-mapfile-delete-entry(8)</literal></simpara>
</section>
</section>
<section id="grid-mapfile-delete-entry">
<title>GRID-MAPFILE-DELETE-ENTRY(8)</title>
<section id="_name_12">
<title>NAME</title>
<simpara>grid-mapfile-delete-entry - Remove entries from a gridmap file</simpara>
</section>
<section id="_synopsis_12">
<title>SYNOPSIS</title>
<simpara><emphasis role="strong"><literal>grid-mapfile-delete-entry</literal></emphasis> [<literal>-help</literal> ] [<literal>-usage</literal> ] [<literal>-version</literal> ] [<literal>-versions</literal> ]</simpara>
</section>
<section id="_description_12">
<title>Description</title>
<simpara>The <emphasis role="strong"><literal>grid-mapfile-delete-entry</literal></emphasis> program deletes mappings from a
gridmap file. If both the <emphasis>-dn</emphasis> and <emphasis>-ln</emphasis>&gt; options are specified,
<emphasis role="strong"><literal>grid-mapfile-delete-entry</literal></emphasis> removes entries which meet both
criteria (remove entries mapping <emphasis>DISTINGUISHED-NAME</emphasis> to <emphasis>LOCAL-NAME</emphasis>
for each <emphasis>LOCAL-NAME</emphasis> specified). If only <emphasis>-dn</emphasis> or <emphasis>-ln</emphasis> is specified
<emphasis role="strong">all</emphasis> entries for that <emphasis>DISTINGUISHED-NAME</emphasis> or <emphasis>LOCAL-NAME</emphasis> are
removed.</simpara>
<simpara>By default, <emphasis role="strong"><literal>grid-mapfile-delete-entry</literal></emphasis> will modify the gridmap
file named by the <literal>GRIDMAP</literal> environment variable if present, or the
file <literal>/etc/grid-security/grid-mapfile</literal> if not. This can be changed by
the use of the  if not. This can be changed by the use of the <emphasis>-mapfile</emphasis>
or <emphasis>-f</emphasis> command-line options.</simpara>
<simpara>Prior to modifying a gridmap file, <emphasis role="strong"><literal>grid-mapfile-delete-entry</literal></emphasis>
saves its current contents to a file with the string <literal>.old</literal> appended
to the original file name.</simpara>
<simpara>The full set of command-line options to
<emphasis role="strong"><literal>grid-mapfile-delete-entry</literal></emphasis> are:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong">-help, -usage</emphasis>
</term>
<listitem>
<simpara>
     Display the command-line options to <emphasis role="strong"><literal>grid-mapfile-delete-entry</literal></emphasis>.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-version, -versions</emphasis>
</term>
<listitem>
<simpara>
     Display the version number of the <emphasis role="strong"><literal>grid-mapfile-delete-entry</literal></emphasis> command. The second form includes more details.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-dn <emphasis>DISTINGUISHED-NAME</emphasis></emphasis>
</term>
<listitem>
<simpara>
     The X.509 distinguished name to remove from the gridmap file. If the <emphasis>-ln</emphasis> option is not specified, remove all entries for this name; otherwise, remove entries that match both this name and the local name. The name should be in OpenSSL&#8217;s <literal>oneline</literal> format.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-ln <emphasis>LOCAL-NAME</emphasis>&#8230;</emphasis>
</term>
<listitem>
<simpara>
     The POSIX user name to remove from the gridmap file. Include multiple <emphasis>LOCAL-NAME</emphasis> strings after the <emphasis>-ln</emphasis> command-line option to remove multiple names from the gridmap. If the <emphasis>-dn</emphasis> option is not specifeid, remove all entries for these names; otherwise, remove entries that match the <emphasis>DISTINGUISHED-NAME</emphasis> and any of the <emphasis>LOCAL-NAME</emphasis> values.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-d, -dryrun</emphasis>
</term>
<listitem>
<simpara>
     Display diagnostics about what would be removed from the gridmap file, but don&#8217;t actually modify the file.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
<emphasis role="strong">-mapfile <emphasis>MAPFILE</emphasis>, -f <emphasis>MAPFILE</emphasis></emphasis>
</term>
<listitem>
<simpara>
     Modify the gridmap file named by <emphasis>MAPFILE</emphasis> instead of the default.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_examples_9">
<title>Examples</title>
<simpara>Remove all mappings for a distinguished name:</simpara>
<screen>%  grid-mapfile-delete-entry "/DC=org/DC=example/DC=grid/CN=Joe User"
Modifying /etc/grid-security/grid-mapfile ...
Deleting entry: "/DC=org/DC=example/DC=grid/CN=Joe User" juser,juser2
(1) entry deleted</screen>
<simpara>Remove the mapping between a distinguished name and a single local
username:</simpara>
<screen>%  grid-mapfile-delete-entry "/DC=org/DC=example/DC=grid/CN=Joe User" -ln juser2
Modifying /etc/grid-security/grid-mapfile ...
Current entry: "/DC=org/DC=example/DC=grid/CN=Joe User" juser
(1) mapping removed: (juser2), (0) not present and ignored
(0) entries deleted</screen>
</section>
<section id="_environment_variables_10">
<title>Environment Variables</title>
<simpara>The following environment variables affect the execution of
<emphasis role="strong"><literal>grid-mapfile-delete-entry</literal></emphasis>:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong"><literal>GRIDMAP</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the default gridmap to modify.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_files_5">
<title>Files</title>
<simpara>The following files affect the execution of
<emphasis role="strong"><literal>grid-mapfile-delete-entry</literal></emphasis>:</simpara>
<variablelist>
<varlistentry>
<term>
<emphasis role="strong"><literal>/etc/grid-security/grid-mapfile</literal></emphasis>
</term>
<listitem>
<simpara>
     Path to the default gridmap to modify if <literal>GRIDMAP</literal> environment variable is not set.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section id="_see_also_7">
<title>See Also</title>
<simpara><literal>grid-mapfile-add-entry(8)</literal>, <literal>grid-mapfile-check-consistency(8)</literal></simpara>
</section>
</section>
</chapter>
<chapter id="gsic-user-troubleshooting">
<title>Troubleshooting</title>
<simpara>The following includes common errors for credentials and gridmap files.
For information about system administrator logs, see
<ulink url="../..gsic/admin/index.html#gsic-admin-debugging">../..gsic/admin/index.html#gsic-admin-debugging</ulink> in the GSI C
Admin Guide.</simpara>
<section id="security-credential-troubleshooting">
<title>Credential Troubleshooting</title>
<section id="security-credential-errors">
<title>Credential Errors</title>
<simpara>The following are some common problems that may cause clients or servers
to report that credentials are invalid:</simpara>
<table
frame="all"
rowsep="1" colsep="1"
>
<title>Credential Errors</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="33*"/>
<colspec colname="col_2" colwidth="33*"/>
<colspec colname="col_3" colwidth="33*"/>
<thead>
<row>
<entry align="left" valign="top"> Error Code </entry>
<entry align="left" valign="top"> Definition </entry>
<entry align="left" valign="top"> Possible Solutions</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>Your proxy credential may have expired</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Your proxy credential may have expired.</simpara></entry>
<entry align="left" valign="top"><simpara>Use <ulink url="gsic/pi/index.html#grid-proxy-info">grid-proxy-info</ulink> to check
whether the proxy credential has actually expired. If it has,
generate a new proxy with <ulink url="gsic/pi/index.html#grid-proxy-init">grid-proxy-init</ulink>.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>The system clock on either the local or remote system
is wrong.</literal></simpara></entry>
<entry align="left" valign="top"><simpara>This may cause the server or client to conclude that a
credential has expired.</simpara></entry>
<entry align="left" valign="top"><simpara>Check the system clocks on the local and remote
system.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>Your end-user certificate may have
expired</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Your end-user certificate may have expired</simpara></entry>
<entry align="left" valign="top"><simpara>Use <ulink url="gsic/pi/index.html#grid-cert-info">grid-cert-info</ulink> to check your
certificate&#8217;s expiration date. If it has expired, follow your CA&#8217;s
procedures to get a new one.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>The permissions may be wrong on your proxy
file</literal></simpara></entry>
<entry align="left" valign="top"><simpara>If the permissions on your proxy file are too lax (for
example, if others can read your proxy file), Globus Toolkit
clients will not use that file to authenticate.</simpara></entry>
<entry align="left" valign="top"><simpara>You can "fix" this problem by changing the permissions on
the file or by destroying it (with <ulink url="gsic/pi/index.html#grid-proxy-destroy">grid-proxy-destroy</ulink>) and creating a new one (with <ulink url="gsic/pi/index.html#grid-proxy-init">grid-proxy-init</ulink>).</simpara>
<simpara>[IMPORTANT]</simpara>
<simpara>However, it
is still possible that someone else has made a copy of that file
during the time that the permissions were wrong. In that case,
they will be able to impersonate you until the proxy file expires
or your permissions or end-user certificate are revoked, whichever
happens first.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>The permissions may be wrong on your private key
file</literal></simpara></entry>
<entry align="left" valign="top"><simpara>If the permissions on your end user certificate private key
file are too lax (for example, if others can read the file),
grid-proxy-init will refuse to create a proxy certificate.</simpara></entry>
<entry align="left" valign="top"><simpara>You can "fix" this by changing the permissions on the
private key file.</simpara>
<simpara>[IMPORTANT]</simpara>
<simpara>However, you will still have a
much more serious problem: it is possible that someone has made a
copy of your private key file. Although this file is encrypted, it
is possible that someone will be able to decrypt the private key,
at which point they will be able to impersonate you as long as
your end user certificate is valid. You should contact your CA to
have your end-user certificate revoked and get a new
one.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>The remote system may not trust your
CA</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The remote system may not trust your CA</simpara></entry>
<entry align="left" valign="top"><simpara>Verify that the remote system is configured to trust the CA
that issued your end-entity certificate. See link:admin/install/index.html for details.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>You may not trust the remote system&#8217;s
CA</literal></simpara></entry>
<entry align="left" valign="top"><simpara>You may not trust the remote system&#8217;s CA</simpara></entry>
<entry align="left" valign="top"><simpara>Verify that your system is configured to trust the remote
CA (or that your environment is set up to trust the remote CA).
See admin/install/index.html for details.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>There may be something wrong with the remote
service&#8217;s credentials</literal></simpara></entry>
<entry align="left" valign="top"><simpara>There may be something wrong with the remote service&#8217;s
credentials</simpara></entry>
<entry align="left" valign="top"><simpara>It is sometimes difficult to distinguish between errors
reported by the remote service regarding your credentials and
errors reported by the client interface regarding the remote
service&#8217;s credentials. If you cannot find anything wrong with your
credentials, check for the same conditions on the remote system
(or ask a remote administrator to do so) .</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
</section>
<section id="security-credential-troubleshooting-tools">
<title>Some tools to validate certificate setup</title>
<section id="_grid_cert_diagnostics">
<title>grid-cert-diagnostics</title>
<simpara>The
<ulink url="../..gsic/user/index.html#grid-cert-diagnostics"><emphasis role="strong"><literal>grid-cert-diagnostics</literal></emphasis></ulink>
program checks prints diagnostics about the user&#8217;s certificates, and
host security environment.</simpara>
<screen>%  grid-cert-diagnostics -p</screen>
</section>
<section id="_check_that_the_user_certificate_is_valid">
<title>Check that the user certificate is valid</title>
<screen>openssl verify -CApath /etc/grid-security/certificates
  -purpose sslclient ~/.globus/usercert.pem</screen>
</section>
<section id="_connect_to_the_server_using_s_client">
<title>Connect to the server using s_client</title>
<screen>openssl s_client -ssl3 -cert ~/.globus/usercert.pem -key
  ~/.globus/userkey.pem -CApath /etc/grid-security/certificates
  -connect &lt;host:port&gt;</screen>
<simpara>Here <emphasis>&lt;host:port&gt;</emphasis> denotes the server and port you connect to.</simpara>
<simpara>If it prints an error and puts you back at the command prompt, then it
typically means that the <emphasis role="strong">server</emphasis> has closed the connection, i.e. that
the server was not happy with the client&#8217;s certificate and verification.
Check the SSL log on the server.</simpara>
<simpara>If the command "hangs" then it has actually opened a telnet style (but
secure) socket, and you can "talk" to the server.</simpara>
<simpara>You should be able to scroll up and see the subject names of the
server&#8217;s verification chain:</simpara>
<screen>depth=2 /DC=net/DC=ES/O=ESnet/OU=Certificate Authorities/CN=ESnet Root CA 1
verify return:1
depth=1 /DC=org/DC=DOEGrids/OU=Certificate Authorities/CN=DOEGrids CA 1
verify return:1
depth=0 /DC=org/DC=doegrids/OU=Services/CN=wiggum.mcs.anl.gov
verify return:1</screen>
<simpara>In this case, there were no errors. Errors would give you an extra line
next to the subject name of the certificate that caused the error.</simpara>
</section>
<section id="_check_that_the_server_certificate_is_valid">
<title>Check that the server certificate is valid</title>
<simpara>Requires root login on server:</simpara>
<screen>    openssl verify -CApath /etc/grid-security/certificates -purpose sslserver
     /etc/grid-security/hostcert.pem</screen>
</section>
</section>
</section>
<section id="security-gridmap-troubleshooting">
<title>Grid map Troubleshooting</title>
<section id="_grid_map_errors">
<title>Grid map errors</title>
<simpara>The following are some common problems that may cause clients or servers
to report that user are not authorized:</simpara>
<table id="gridmap-errors-table"
frame="all"
rowsep="1" colsep="1"
>
<title>Gridmap Errors</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="33*"/>
<colspec colname="col_2" colwidth="33*"/>
<colspec colname="col_3" colwidth="33*"/>
<thead>
<row>
<entry align="left" valign="top"> Error Code </entry>
<entry align="left" valign="top"> Definition </entry>
<entry align="left" valign="top"> Possible Solutions</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>The content of the grid map file does not conform to the expected format</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The content of the grid map file does not conform to the expected format</simpara></entry>
<entry align="left" valign="top"><simpara>Run <ulink url="../../gsic/pi/index.html#grid-mapfile-check-consistency"><emphasis role="strong"><literal>grid-mapfile-check-consistency</literal></emphasis></ulink> to make sure that your gridmap file conforms to the expected format.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>The grid map file does not contain a entry for your DN</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The grid map file does not contain a entry for your DN</simpara></entry>
<entry align="left" valign="top"><simpara>Use <ulink url="../../gsic/pi/index.html#grid-mapfile-add-entry"><emphasis role="strong"><literal>grid-mapfile-add-entry</literal></emphasis></ulink> to add the relevant entry.</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
</section>
</section>
</chapter>
</book>
